name: "sqlmap"
command: "sqlmap"
enabled: true

# 简短描述（用于工具列表，减少token消耗）
short_description: "自动化SQL注入检测和利用工具，用于发现和利用SQL注入漏洞"

# 工具详细描述
description: |
  自动化SQL注入检测和利用工具，用于发现和利用SQL注入漏洞。
  
  **主要功能：**
  - 自动检测SQL注入漏洞
  - 支持多种数据库类型（MySQL, PostgreSQL, Oracle, MSSQL等）
  - 自动提取数据库信息（表、列、数据）
  - 支持多种注入技术（布尔盲注、时间盲注、联合查询等）
  - 支持文件上传/下载、命令执行等高级功能
  
  **使用场景：**
  - Web应用安全测试
  - SQL注入漏洞检测
  - 数据库信息收集
  - 渗透测试和漏洞验证
  
  **注意事项：**
  - 仅用于授权的安全测试
  - 某些操作可能对目标系统造成影响
  - 建议在测试环境中先验证
  - 使用 --batch 参数避免交互式提示

# 参数定义
parameters:
  - name: "url"
    type: "string"
    description: |
      目标URL，包含可能存在SQL注入的参数。
      
      **格式要求：**
      - 完整的URL，包含协议（http:// 或 https://）
      - 必须包含查询参数，参数值用 * 标记注入点
      - 或者直接提供完整的URL，sqlmap会自动检测参数
      
      **示例值：**
      - 标记注入点: "http://example.com/page?id=1*"
      - 完整URL: "http://example.com/page?id=1"
      - POST数据: "http://example.com/login" (需要配合data参数)
      - Cookie注入: "http://example.com/page" (需要配合cookie参数)
      
      **注意事项：**
      - URL必须可访问
      - 确保URL格式正确，包含协议前缀
      - 如果使用POST请求，需要配合data参数
      - 必需参数，不能为空
    required: true
    flag: "-u"
    format: "flag"
  
  - name: "batch"
    type: "bool"
    description: |
      非交互模式，自动选择默认选项，不需要用户输入。
      
      **使用场景：**
      - 自动化测试脚本
      - 批量扫描
      - 避免交互式提示
      
      **注意事项：**
      - 建议始终设置为true，避免工具等待用户输入
      - 默认值为true
    required: false
    default: true
    flag: "--batch"
    format: "flag"
  
  - name: "level"
    type: "int"
    description: |
      测试级别，范围1-5，级别越高测试越全面但耗时越长。
      
      **级别说明：**
      - Level 1: 基本测试，快速但可能遗漏漏洞
      - Level 2: 默认级别，平衡速度和覆盖率
      - Level 3: 扩展测试，更全面的检测
      - Level 4: 深度测试，包含更多payload
      - Level 5: 最全面测试，包含所有已知技术
      
      **建议：**
      - 快速扫描使用1-2
      - 常规测试使用3（默认）
      - 深度测试使用4-5
      
      **注意事项：**
      - 级别越高，请求数量越多，可能被WAF拦截
      - 默认值为3
    required: false
    default: 3
    flag: "--level"
    format: "combined"  # --level=3

